<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Portable PostgreSQL distribution for Windows</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://carlomorelli.github.io/favicon.ico">

    <link rel="stylesheet" type="text/css" href="//carlomorelli.github.io/themes/casper/assets/css/screen.css?v=1494099515863" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />

    <link rel="canonical" href="https://carlomorelli.github.io/2017/04/23/Portable-PostgreSQL-distribution-for-Windows.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Portable PostgreSQL distribution for Windows" />
    <meta property="og:description" content="For a personal project in Java I was using the well-known H2 database (which is implemented in Java itself). H2 is a great, easy-to-use db and personally I always like to keep things simple. However, if you are targeting the Cloud, sooner or later you will need advanced features like" />
    <meta property="og:url" content="https://carlomorelli.github.io/2017/04/23/Portable-PostgreSQL-distribution-for-Windows.html" />
    <meta property="article:tag" content="Postgres" />
    <meta property="article:tag" content=" Windows" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Portable PostgreSQL distribution for Windows" />
    <meta name="twitter:description" content="For a personal project in Java I was using the well-known H2 database (which is implemented in Java itself). H2 is a great, easy-to-use db and personally I always like to keep things simple. However, if you are targeting the Cloud, sooner or later you will need advanced features like" />
    <meta name="twitter:url" content="https://carlomorelli.github.io/2017/04/23/Portable-PostgreSQL-distribution-for-Windows.html" />
    
    <script type="application/ld+json">
null
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="" href="https://carlomorelli.github.io/rss/" />
</head>
<body class="post-template tag-Postgres tag-Windows nav-closed">

    

    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-Postgres tag-Windows">

        <header class="post-header">
            <h1 class="post-title">Portable PostgreSQL distribution for Windows</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2017-04-23">23 April 2017</time>  on <a href="https://carlomorelli.github.io/tag/Postgres/">Postgres</a>, <a href="https://carlomorelli.github.io/tag/Windows/"> Windows</a>
            </section>
        </header>

        <section class="post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>For a personal project in Java I was using the well-known <a href="http://www.h2database.com/html/main.html">H2 database</a> (which is implemented in Java itself).</p>
</div>
<div class="paragraph">
<p>H2 is a great, easy-to-use db and personally I always like to keep things simple. However, if you are targeting the Cloud, sooner or later you will need advanced features like  networked DB server, user management and  connection pooling, so finally I decided to get a grip and move from H2 to something more Enterprise-level.</p>
</div>
<div class="paragraph">
<p>After some research about the DB platform to adopt, I opted for Postgres. In this post I will show an easy way to deploy an installer-less Postgres on Windows machines&#8201;&#8212;&#8201;something many people on the Internet call 'portable version'.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install_and_configure_portable_postgres">Install and configure 'portable' Postgres</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On my Windows pc I like to micromanage the system and keep things tidy. If a software I need offers the 'zip' binary archive to download instead of any MSI/EXE installer, I usually go that way.</p>
</div>
<div class="paragraph">
<p>I put normal software blobs in a <code>C:\opt</code> folder, and if it is developement-related software, I use the  <code>C:\workspace\opt</code> folder (as <code>C:\workspace</code> is the root of all my code). Yes yes I know, bad habits from Linux&#8230;&#8203; moving on :P</p>
</div>
<div class="paragraph">
<p>It happens that Postgres offers precisely this: <a href="https://www.enterprisedb.com/download-postgresql-binaries" class="bare">https://www.enterprisedb.com/download-postgresql-binaries</a>. So time to download the <em>Win-x86-64</em> blob for version 9.5.6 and unpack it.</p>
</div>
<div class="paragraph">
<p>The binary blob provides not only the classic Pgsql commands (initdb, dropdb, psql), but also the handy pgAdminIII frontend. In the root folder of the unpacked software (in my case, <code>C:\workspace\opt\postgres-9.5.6\</code>), then, create the batch file <code>launch_pg.bat</code> with this content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>REM contents
@echo off
set PATH="%~dp0\bin";%PATH%
set PGDATA=%~dp0\data
set PGDATABASE=postgres
set PGUSER=postgres
set PGPORT=5439
set PGLOCALEDIR=%~dp0\share\locale
"%~dp0\bin\initdb" -U postgres -A trust
"%~dp0\bin\pg_ctl" -D "%~dp0/data" -l logfile start
echo "#### Ready. Press space to shutdown..."
pause &gt; null
"%~dp0\bin\pg_ctl" -D "%~dp0/data" stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are wondering, <code>%~dp0</code> variable return the current directory&#8201;&#8212;&#8201;that is, the directory where the .bat file is being executed.</p>
</div>
<div class="paragraph">
<p><strong>WARNING</strong>: The first run of this script will initialize the database in the <code>%PGDATA%</code> directory with the <code>initdb</code> line. <em>For the following launches, remember to comment that line</em>, otherwise you&#8217;ll see some error message popping up.</p>
</div>
<div class="paragraph">
<p>At this point, I am basically done: I&#8217;ll just create Desktop launchers for both this .bat file and the pgAdmin.exe file that you can find in <code>bin\</code>. As you can understand my need is to launch and terminate the server on-demand.</p>
</div>
<div class="paragraph">
<p>However, other people may want to launch Postgres as system service or scheduled task (at startup). If that&#8217;s the case, I suggest to create a startup task in Windows' Task Scheduler in Control Panel.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_db_server_to_use_a_small_comparison">What DB server to use? a small comparison</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Few words on why I chose Postgres? Basically, because it is mantained and popular, it is the one I felt more confortable together with MySQL, with the advantage that installing it on Windows is relatively painless&#8201;&#8212;&#8201;as you can see. Also, apparently it is the most lightweight of all: my home machine is not that great&#8201;&#8212;&#8201;it&#8217;s a desktop-replacement laptop from 2012 with Windows 7, so no heavy loads thank you :-).
In general the choice was limited to the followings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MySQL / mariaDB</p>
<div class="ulist">
<ul>
<li>
<p>Pro: fast, stable, open-source</p>
</li>
<li>
<p>Con: large installation, complex on Windows</p>
</li>
</ul>
</div>
</li>
<li>
<p>PostgreSQL (aka Postgres, aka Pg)</p>
<div class="ulist">
<ul>
<li>
<p>Pro: the most deployed, documented, and developed; open-source; the installation package is &lt; 100 Mb for version 9.5</p>
</li>
<li>
<p>Con: Not very fast for big transactions</p>
</li>
</ul>
</div>
</li>
<li>
<p>Microsoft SQLServer 2017 Developer</p>
<div class="ulist">
<ul>
<li>
<p>Pro: free, the most enterprise-grade probably</p>
</li>
<li>
<p>Con: super difficult to configure, non open, and with a laaaaarge installation</p>
</li>
</ul>
</div>
</li>
<li>
<p>A NoSQL database</p>
<div class="ulist">
<ul>
<li>
<p>Pro: really fast developing field in the recent years</p>
</li>
<li>
<p>Con: it is a fragmented field, with many products specialized on different aspects (eg. ElasticSearch on clustered responsiveness, MongoDB on data reliability, ArangoDB on other features); also, generally the noSQL dbs are not lightweight</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The drawbacks of using a SQL RDBMS instead of a NoSQL db is that <em>it is more complicated</em>. You have not only to manage relational data in SQL transactions (which don&#8217;t always map easily to object-oriented patterns, regardless of what you thing of ORM libraries), but also you have to account for Schema formatting and preparation in your app, database migrations and so on.</p>
</div>
<div class="paragraph">
<p>In a next blog post, I will discuss how I manage Postgres (via a connection-pool) using the canonical Java JDBC way. Stay tuned!</p>
</div>
</div>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="https://carlomorelli.github.io/author/carlomorelli/" style="background-image: url(https://avatars3.githubusercontent.com/u/6968441?v&#x3D;3)"><span class="hidden">Carlo Morelli's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="https://carlomorelli.github.io/author/carlomorelli/">Carlo Morelli</a></h4>

                    <p>Read <a href="https://carlomorelli.github.io/author/carlomorelli/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Portable%20PostgreSQL%20distribution%20for%20Windows&amp;url=https://carlomorelli.github.io/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://carlomorelli.github.io/"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://carlomorelli.github.io/"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


    </article>

</main>

<aside class="read-next">
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="https://carlomorelli.github.io"></a> &copy; 2017</section>
            <section class="poweredby">Proudly published with <a href="http://hubpress.io">HubPress</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>

    <script type="text/javascript" src="//carlomorelli.github.io/themes/casper/assets/js/jquery.fitvids.js?v=1494099515863"></script>
    <script type="text/javascript" src="//carlomorelli.github.io/themes/casper/assets/js/index.js?v=1494099515863"></script>

</body>
</html>
